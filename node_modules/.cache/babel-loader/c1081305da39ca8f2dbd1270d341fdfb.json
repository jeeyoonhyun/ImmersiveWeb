{"ast":null,"code":"import _classCallCheck from \"/Users/jeeyoonhyun/immersive-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jeeyoonhyun/immersive-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jeeyoonhyun/immersive-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/jeeyoonhyun/immersive-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Pass } from '../postprocessing/Pass.js';\n\nvar MaskPass = /*#__PURE__*/function (_Pass) {\n  _inherits(MaskPass, _Pass);\n\n  var _super = _createSuper(MaskPass);\n\n  function MaskPass(scene, camera) {\n    var _this;\n\n    _classCallCheck(this, MaskPass);\n\n    _this = _super.call(this);\n    _this.scene = scene;\n    _this.camera = camera;\n    _this.clear = true;\n    _this.needsSwap = false;\n    _this.inverse = false;\n    return _this;\n  }\n\n  _createClass(MaskPass, [{\n    key: \"render\",\n    value: function render(renderer, writeBuffer, readBuffer\n    /*, deltaTime, maskActive */\n    ) {\n      var context = renderer.getContext();\n      var state = renderer.state; // don't update color or depth\n\n      state.buffers.color.setMask(false);\n      state.buffers.depth.setMask(false); // lock buffers\n\n      state.buffers.color.setLocked(true);\n      state.buffers.depth.setLocked(true); // set up stencil\n\n      var writeValue, clearValue;\n\n      if (this.inverse) {\n        writeValue = 0;\n        clearValue = 1;\n      } else {\n        writeValue = 1;\n        clearValue = 0;\n      }\n\n      state.buffers.stencil.setTest(true);\n      state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\n      state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\n      state.buffers.stencil.setClear(clearValue);\n      state.buffers.stencil.setLocked(true); // draw into the stencil buffer\n\n      renderer.setRenderTarget(readBuffer);\n      if (this.clear) renderer.clear();\n      renderer.render(this.scene, this.camera);\n      renderer.setRenderTarget(writeBuffer);\n      if (this.clear) renderer.clear();\n      renderer.render(this.scene, this.camera); // unlock color and depth buffer for subsequent rendering\n\n      state.buffers.color.setLocked(false);\n      state.buffers.depth.setLocked(false); // only render where stencil is set to 1\n\n      state.buffers.stencil.setLocked(false);\n      state.buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1\n\n      state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\n      state.buffers.stencil.setLocked(true);\n    }\n  }]);\n\n  return MaskPass;\n}(Pass);\n\nvar ClearMaskPass = /*#__PURE__*/function (_Pass2) {\n  _inherits(ClearMaskPass, _Pass2);\n\n  var _super2 = _createSuper(ClearMaskPass);\n\n  function ClearMaskPass() {\n    var _this2;\n\n    _classCallCheck(this, ClearMaskPass);\n\n    _this2 = _super2.call(this);\n    _this2.needsSwap = false;\n    return _this2;\n  }\n\n  _createClass(ClearMaskPass, [{\n    key: \"render\",\n    value: function render(renderer\n    /*, writeBuffer, readBuffer, deltaTime, maskActive */\n    ) {\n      renderer.state.buffers.stencil.setLocked(false);\n      renderer.state.buffers.stencil.setTest(false);\n    }\n  }]);\n\n  return ClearMaskPass;\n}(Pass);\n\nexport { MaskPass, ClearMaskPass };","map":{"version":3,"sources":["/Users/jeeyoonhyun/immersive-web/node_modules/three/examples/jsm/postprocessing/MaskPass.js"],"names":["Pass","MaskPass","scene","camera","clear","needsSwap","inverse","renderer","writeBuffer","readBuffer","context","getContext","state","buffers","color","setMask","depth","setLocked","writeValue","clearValue","stencil","setTest","setOp","REPLACE","setFunc","ALWAYS","setClear","setRenderTarget","render","EQUAL","KEEP","ClearMaskPass"],"mappings":";;;;AAAA,SAASA,IAAT,QAAqB,2BAArB;;IAEMC,Q;;;;;AAEL,oBAAaC,KAAb,EAAoBC,MAApB,EAA6B;AAAA;;AAAA;;AAE5B;AAEA,UAAKD,KAAL,GAAaA,KAAb;AACA,UAAKC,MAAL,GAAcA,MAAd;AAEA,UAAKC,KAAL,GAAa,IAAb;AACA,UAAKC,SAAL,GAAiB,KAAjB;AAEA,UAAKC,OAAL,GAAe,KAAf;AAV4B;AAY5B;;;;WAED,gBAAQC,QAAR,EAAkBC,WAAlB,EAA+BC;AAAW;AAA1C,MAAyE;AAExE,UAAMC,OAAO,GAAGH,QAAQ,CAACI,UAAT,EAAhB;AACA,UAAMC,KAAK,GAAGL,QAAQ,CAACK,KAAvB,CAHwE,CAKxE;;AAEAA,MAAAA,KAAK,CAACC,OAAN,CAAcC,KAAd,CAAoBC,OAApB,CAA6B,KAA7B;AACAH,MAAAA,KAAK,CAACC,OAAN,CAAcG,KAAd,CAAoBD,OAApB,CAA6B,KAA7B,EARwE,CAUxE;;AAEAH,MAAAA,KAAK,CAACC,OAAN,CAAcC,KAAd,CAAoBG,SAApB,CAA+B,IAA/B;AACAL,MAAAA,KAAK,CAACC,OAAN,CAAcG,KAAd,CAAoBC,SAApB,CAA+B,IAA/B,EAbwE,CAexE;;AAEA,UAAIC,UAAJ,EAAgBC,UAAhB;;AAEA,UAAK,KAAKb,OAAV,EAAoB;AAEnBY,QAAAA,UAAU,GAAG,CAAb;AACAC,QAAAA,UAAU,GAAG,CAAb;AAEA,OALD,MAKO;AAEND,QAAAA,UAAU,GAAG,CAAb;AACAC,QAAAA,UAAU,GAAG,CAAb;AAEA;;AAEDP,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBC,OAAtB,CAA+B,IAA/B;AACAT,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBE,KAAtB,CAA6BZ,OAAO,CAACa,OAArC,EAA8Cb,OAAO,CAACa,OAAtD,EAA+Db,OAAO,CAACa,OAAvE;AACAX,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBI,OAAtB,CAA+Bd,OAAO,CAACe,MAAvC,EAA+CP,UAA/C,EAA2D,UAA3D;AACAN,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBM,QAAtB,CAAgCP,UAAhC;AACAP,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBH,SAAtB,CAAiC,IAAjC,EAnCwE,CAqCxE;;AAEAV,MAAAA,QAAQ,CAACoB,eAAT,CAA0BlB,UAA1B;AACA,UAAK,KAAKL,KAAV,EAAkBG,QAAQ,CAACH,KAAT;AAClBG,MAAAA,QAAQ,CAACqB,MAAT,CAAiB,KAAK1B,KAAtB,EAA6B,KAAKC,MAAlC;AAEAI,MAAAA,QAAQ,CAACoB,eAAT,CAA0BnB,WAA1B;AACA,UAAK,KAAKJ,KAAV,EAAkBG,QAAQ,CAACH,KAAT;AAClBG,MAAAA,QAAQ,CAACqB,MAAT,CAAiB,KAAK1B,KAAtB,EAA6B,KAAKC,MAAlC,EA7CwE,CA+CxE;;AAEAS,MAAAA,KAAK,CAACC,OAAN,CAAcC,KAAd,CAAoBG,SAApB,CAA+B,KAA/B;AACAL,MAAAA,KAAK,CAACC,OAAN,CAAcG,KAAd,CAAoBC,SAApB,CAA+B,KAA/B,EAlDwE,CAoDxE;;AAEAL,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBH,SAAtB,CAAiC,KAAjC;AACAL,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBI,OAAtB,CAA+Bd,OAAO,CAACmB,KAAvC,EAA8C,CAA9C,EAAiD,UAAjD,EAvDwE,CAuDT;;AAC/DjB,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBE,KAAtB,CAA6BZ,OAAO,CAACoB,IAArC,EAA2CpB,OAAO,CAACoB,IAAnD,EAAyDpB,OAAO,CAACoB,IAAjE;AACAlB,MAAAA,KAAK,CAACC,OAAN,CAAcO,OAAd,CAAsBH,SAAtB,CAAiC,IAAjC;AAEA;;;;EA3EqBjB,I;;IA+EjB+B,a;;;;;AAEL,2BAAc;AAAA;;AAAA;;AAEb;AAEA,WAAK1B,SAAL,GAAiB,KAAjB;AAJa;AAMb;;;;WAED,gBAAQE;AAAS;AAAjB,MAAyE;AAExEA,MAAAA,QAAQ,CAACK,KAAT,CAAeC,OAAf,CAAuBO,OAAvB,CAA+BH,SAA/B,CAA0C,KAA1C;AACAV,MAAAA,QAAQ,CAACK,KAAT,CAAeC,OAAf,CAAuBO,OAAvB,CAA+BC,OAA/B,CAAwC,KAAxC;AAEA;;;;EAf0BrB,I;;AAmB5B,SAASC,QAAT,EAAmB8B,aAAnB","sourcesContent":["import { Pass } from '../postprocessing/Pass.js';\n\nclass MaskPass extends Pass {\n\n\tconstructor( scene, camera ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis.inverse = false;\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tconst context = renderer.getContext();\n\t\tconst state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tlet writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setLocked( false );\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t}\n\n}\n\nclass ClearMaskPass extends Pass {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.needsSwap = false;\n\n\t}\n\n\trender( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setLocked( false );\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n}\n\nexport { MaskPass, ClearMaskPass };\n"]},"metadata":{},"sourceType":"module"}